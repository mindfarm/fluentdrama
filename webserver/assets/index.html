<! DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title>Fluent Drama</title>
		<script src="vue.js"></script>
	</head>
	<body>
		<div id="banner" style="border: thin solid red">
		All data published in accordance with Article 9, Paragraph 2, point (e)
		of the GDPR. For further information please read 
		<a href="https://gdpr-info.eu/art-9-gdpr/">Article 9</a>.
		</div>
		<div id="channels" style="width: 10em; border: thin solid red">
			<ul style="list-style: none;">
				<channel-name
					v-for="name in channelList"
					v-bind:channel="name"
				></channel-name>
			</ul>
		</div>
		<div id="logs">
			<div v-for="logd in logList">
			<div v-for="l in logd" :key="l.stamp">
				<div class="logdata" v-bind:id="logd.stamp" style="display: contents">
					<span class="when" style="display: inline-block; max-width: max-content">{{String(l.Time).split(".")[0].split(" ")[1] }}</span>
					<span class="who" style="display: inline-block; max-width: max-content">&lt; {{ l.Nick}} &gt;</span>
					<span class="what">{{ l.Said }}</span>
				</div>
				</div>
			</div>
		</div>
		<script type="text/javascript">
			Vue.component('channel-name', {
				props: ['channel'],
				template: '<li><a v-bind:href="`/` + channel.name ">{{ channel.name }}</a></li>'
			})
			var channels = new Vue({
				el: '#channels',
				data: {
					channelList: [
						{ name: '#go-nuts' },
						{ name: '#libera' },
						{ name: '##rust' }
					]
				}
			})
			var logs = new Vue ({
				el: '#logs',
				data () {
					return {
						logList: []
					}
				},
				mounted() {
					fetch('http://mindfarm.nz/%23go-nuts/')
						.then(response => response.json())
						.then(data => (this.logList = data));
				}
			})
		</script>
	</body>
</html>
